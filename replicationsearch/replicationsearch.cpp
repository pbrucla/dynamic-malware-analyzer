/*
Makes with
    asid_instr_count
    asidstory
    callstack_instr
    syscalls2
    replicationsearch
in config.panda
*/

#include "panda/plugin.h"
//#include "syscalls2/syscalls_ext_typedefs.h"
#include "taint2/taint2.h"

extern "C" {
        bool init_plugin(void*);
        void uninit_plugin(void*);

        //API Functions
}

//typedef void (*on_taint_prop_t) (Addr, Addr, uint64_t)

void taint_test(Addr, Addr, uint64_t) {
    printf("Taint Propagated");
}

// void test_one (CPUState *env, target_ulong pc, target_ulong callno)
// {
//         printf("Hello, World!");
// }

bool init_plugin(void *self) {
    //PPP_REG_CB("syscalls2", on_all_sys_return, test_one) ;
    PPP_REG_CB("taint2", on_taint_prop, taint_test) ;
    return true;
}

void uninit_plugin(void *self) {
}
