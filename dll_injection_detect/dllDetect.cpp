#include "syscalls2/syscalls2.h"
#include "syscalls2/syscalls_ext_typedefs.h"



extern "C" {
    //what should occur when plugin is initialized
    //register all of your callbacks you provide and register what callbacks in other plugins you will use
	bool init_plugin(void*);
    //what should occur when plugin terminates
	void uninit_plugin(void*);
    
    //other helper functions that might be used for other plugins to call 
}


panda_cb pcb_startblock; 


bool init_plugin(void *self) {
    PPP_REG_CB("syscalls2", on_NtOpenKey_enter, my_NtOpenKey_enter);
    return true;
}

void my_NtOpenKey_enter(
        CPUState* env,
        target_ulong pc,
        uint32_t KeyHandle,
        uint32_t DesiredAccess,
        uint32_t ObjectAttributes,
        ) {
   printf("NtOpenKey(KeyHandle=%x, DesiredAccess=%x, ObjectAttributes=%x)\n",
        KeyHandle, DesiredAccess, ObjectAttributes);
}